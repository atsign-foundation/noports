version: '3'

services:
  sshnpd-trunk:
    build:
      context: ./contexts/sshnpd
      dockerfile: ./image/Dockerfile
      target: trunk
    image: atsigncompany/sshnp-e2e-trunk # image name
    container_name: sshnpd_trunk # container name
    user: atsign
    volumes:
      - ./contexts/sshnpd/keys/:/atsign/.atsign/keys/ # mount keys
      - ./contexts/sshnpd/entrypoint.sh:/atsign/entrypoint.sh # mount entrypoint
  sshnp-trunk:
    build:
      context: ./contexts/sshnpd
      dockerfile: ./image/Dockerfile
      target: trunk
    depends_on:
      - sshnpd-trunk
    image: atsigncompany/sshnp-e2e-trunk
    container_name: sshnp_trunk # container name
    user: atsign
    volumes:
      - ./contexts/sshnp/keys/:/atsign/.atsign/keys/ # mount keys
      - ./contexts/sshnp/entrypoint.sh:/atsign/entrypoint.sh # mount entrypoint
